<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Banerjee Mart - Cart</title>
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
/>
<style>
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    background: #f5f5f5;
    color: #222;
    padding-bottom: 60px; /* space for bottom nav */
  }

  /* Header */
  header {
    background: #2874f0;
    color: white;
    padding: 12px 16px 12px;
    position: sticky;
    top: 0;
    z-index: 1000;
    text-align: center;
    box-shadow: 0 2px 6px rgb(0 0 0 / 0.15);
  }
  header h1 {
    margin: 0;
    font-weight: 700;
    font-size: 28px;
    letter-spacing: 1.2px;
  }

  /* Cart container */
  #cart-container {
    max-width: 960px;
    margin: 20px auto 100px;
    padding: 0 12px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 12px rgb(0 0 0 / 0.1);
    min-height: 200px;
  }

  /* Cart item */
  .cart-item {
    display: flex;
    align-items: center;
    border-bottom: 1px solid #ddd;
    padding: 14px 0;
  }
  .cart-item:last-child {
    border-bottom: none;
  }
  .cart-item img {
    width: 80px;
    height: 80px;
    object-fit: contain;
    border-radius: 8px;
    margin-right: 16px;
  }
  .item-details {
    flex-grow: 1;
  }
  .item-name {
    font-weight: 700;
    font-size: 18px;
    margin-bottom: 6px;
    color: #222;
  }
  .item-price {
    font-weight: 700;
    font-size: 16px;
    color: #2874f0;
    margin-bottom: 8px;
  }

  /* Qty controls */
  .qty-controls {
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .qty-controls button {
    background: #2874f0;
    color: white;
    border: none;
    border-radius: 4px;
    font-size: 18px;
    width: 30px;
    height: 30px;
    cursor: pointer;
    user-select: none;
    transition: background 0.3s;
    line-height: 1;
  }
  .qty-controls button:hover {
    background: #1e59d9;
  }
  .qty-controls span {
    min-width: 26px;
    text-align: center;
    font-weight: 700;
    font-size: 16px;
  }

  /* Total and checkout */
  #summary {
    margin-top: 20px;
    padding-top: 20px;
    border-top: 2px solid #eee;
    font-size: 18px;
    font-weight: 700;
    display: flex;
    justify-content: space-between;
    color: #222;
  }
  #delivery-charge {
    font-weight: 600;
    font-size: 15px;
    color: #555;
    margin-top: 4px;
  }

  #checkout-btn {
    display: block;
    margin: 28px auto 40px;
    background: #ff6f00;
    color: white;
    font-size: 18px;
    font-weight: 700;
    border: none;
    border-radius: 8px;
    padding: 14px 0;
    width: 90%;
    max-width: 400px;
    cursor: pointer;
    transition: background 0.3s;
  }
  #checkout-btn:hover {
    background: #e65c00;
  }

  /* Empty cart message */
  #empty-msg {
    text-align: center;
    padding: 50px 0;
    color: #777;
    font-size: 18px;
  }

  /* Order confirmation popup overlay */
  #order-popup {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1200;
  }
  #order-popup .popup-content {
    background: white;
    border-radius: 12px;
    width: 90%;
    max-width: 400px;
    padding: 24px 20px 32px;
    box-shadow: 0 6px 20px rgb(0 0 0 / 0.2);
    text-align: center;
    position: relative;
  }
  #order-popup .popup-content h2 {
    margin-top: 0;
    margin-bottom: 12px;
    color: #2874f0;
    font-weight: 700;
  }
  #order-popup .popup-content p {
    margin-bottom: 20px;
    font-size: 16px;
    color: #444;
  }
  #order-popup .popup-content button.close-btn {
    background: #2874f0;
    color: white;
    border: none;
    padding: 10px 20px;
    font-size: 16px;
    font-weight: 700;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.3s;
  }
  #order-popup .popup-content button.close-btn:hover {
    background: #1e59d9;
  }

  /* Bottom Navigation */
  nav.bottom-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 56px;
    background: white;
    box-shadow: 0 -1px 8px rgb(0 0 0 / 0.1);
    display: flex;
    justify-content: space-around;
    align-items: center;
    z-index: 1100;
  }
  nav.bottom-nav a {
    flex-grow: 1;
    text-align: center;
    color: #555;
    font-size: 12px;
    text-decoration: none;
    user-select: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 6px 0 4px;
    transition: color 0.3s;
  }
  nav.bottom-nav a i {
    font-size: 20px;
  }
  nav.bottom-nav a.active,
  nav.bottom-nav a:hover {
    color: #2874f0;
  }
</style>
</head>
<body>

<header>
  <h1>Banerjee Mart</h1>
</header>

<div id="cart-container">
  <!-- Cart items dynamically inserted here -->
</div>

<button id="checkout-btn" aria-label="Confirm order">Confirm Order</button>

<!-- Order confirmation popup -->
<div id="order-popup" role="dialog" aria-modal="true" aria-labelledby="order-title" aria-describedby="order-desc">
  <div class="popup-content">
    <h2 id="order-title">Order Confirmed!</h2>
    <p id="order-desc">Thank you for shopping with Banerjee Mart!</p>
    <button class="close-btn" aria-label="Close confirmation popup">Close</button>
  </div>
</div>

<!-- Bottom Navigation -->
<nav class="bottom-nav">
  <a href="index.html" data-nav="home" title="Home">
    <i class="fas fa-home"></i>
    <span>Home</span>
  </a>
  <a href="cart.html" data-nav="cart" title="Cart" class="active">
    <i class="fas fa-shopping-cart"></i>
    <span>Cart</span>
  </a>
  <a href="profile.html" data-nav="profile" title="Profile">
    <i class="fas fa-user"></i>
    <span>Profile</span>
  </a>
</nav>

<script>
  const products = [
    { id: 1, name: "Organic Rice", category: "Groceries", price: 450, image: "https://raw.githubusercontent.com/Swarup2024web/Tester/main/assets/rice.png" },
    { id: 2, name: "Apple Juice", category: "Foods", price: 120, image: "https://raw.githubusercontent.com/Swarup2024web/Tester/main/assets/apple-juice.png" },
    { id: 3, name: "Shampoo", category: "Personal Care", price: 200, image: "https://raw.githubusercontent.com/Swarup2024web/Tester/main/assets/shampoo.png" },
    { id: 4, name: "Notebook", category: "Stationery", price: 40, image: "https://raw.githubusercontent.com/Swarup2024web/Tester/main/assets/notebook.png" },
    { id: 5, name: "Cooking Oil", category: "Groceries", price: 150, image: "https://raw.githubusercontent.com/Swarup2024web/Tester/main/assets/oil.png" },
    { id: 6, name: "Chocolate Cake", category: "Foods", price: 350, image: "https://raw.githubusercontent.com/Swarup2024web/Tester/main/assets/cake.png" },
    { id: 7, name: "Soap Bar", category: "Personal Care", price: 35, image: "https://raw.githubusercontent.com/Swarup2024web/Tester/main/assets/soap.png" },
    { id: 8, name: "Pen Set", category: "Stationery", price: 70, image: "https://raw.githubusercontent.com/Swarup2024web/Tester/main/assets/pen.png" },
  ];

  let cart = {
    1: 2,
    3: 1,
    4: 3,
  };

  const cartContainer = document.getElementById("cart-container");
  const checkoutBtn = document.getElementById("checkout-btn");
  const orderPopup = document.getElementById("order-popup");
  const orderDesc = document.getElementById("order-desc");
  const closePopupBtn = orderPopup.querySelector(".close-btn");

  function renderCart() {
    cartContainer.innerHTML = "";
    const cartItems = Object.entries(cart).filter(([id, qty]) => qty > 0);
    if (cartItems.length === 0) {
      cartContainer.innerHTML = '<div id="empty-msg">Your cart is empty.</div>';
      checkoutBtn.style.display = "none";
      return;
    }
    checkoutBtn.style.display = "block";

    cartItems.forEach(([id, qty]) => {
      const product = products.find((p) => p.id == id);
      if (!product) return;
      const itemDiv = document.createElement("div");
      itemDiv.className = "cart-item";
      itemDiv.innerHTML = `
        <img src="${product.image}" alt="${product.name}" />
        <div class="item-details">
          <div class="item-name">${product.name}</div>
          <div class="item-price">₹${(product.price * qty).toFixed(2)}</div>
          <div class="qty-controls" aria-label="Quantity controls for ${product.name}">
            <button class="dec" aria-label="Decrease quantity of ${product.name}">-</button>
            <span class="qty">${qty}</span>
            <button class="inc" aria-label="Increase quantity of ${product.name}">+</button>
          </div>
        </div>
      `;

      const decBtn = itemDiv.querySelector(".dec");
      const incBtn = itemDiv.querySelector(".inc");
      const qtySpan = itemDiv.querySelector(".qty");
      const priceDiv = itemDiv.querySelector(".item-price");

      decBtn.addEventListener("click", () => {
        if (cart[id] > 1) {
          cart[id]--;
        } else {
          if (confirm(`Remove ${product.name} from cart?`)) {
            delete cart[id];
          }
        }
        renderCart();
        updateTotal();
      });
      incBtn.addEventListener("click", () => {
        cart[id]++;
        renderCart();
        updateTotal();
      });

      cartContainer.appendChild(itemDiv);
    });

    updateTotal();
  }

  function updateTotal() {
    const oldSummary = document.getElementById("summary");
    if (oldSummary) oldSummary.remove();

    let total = 0;
    for (const [id, qty] of Object.entries(cart)) {
      const prod = products.find((p) => p.id == id);
      if (prod) total += prod.price * qty;
    }

    const deliveryCharge = total >= 199 ? 0 : (total === 0 ? 0 : 5);

    const summary = document.createElement("div");
    summary.id = "summary";
    summary.innerHTML = `
      <div>
        Total: ₹${total.toFixed(2)}
        <div id="delivery-charge" style="font-weight: normal; font-size: 14px; color: ${deliveryCharge === 0 ? '#2e7d32' : '#c62828'};">
          Delivery: ${deliveryCharge === 0 ? 'Free' : `₹${deliveryCharge.toFixed(2)}`}
        </div>
      </div>
      <div><strong>Grand Total: ₹${(total + deliveryCharge).toFixed(2)}</strong></div>
    `;

    cartContainer.appendChild(summary);
  }

  checkoutBtn.addEventListener("click", () => {
    let total = 0;
    for (const [id, qty] of Object.entries(cart)) {
      const prod = products.find((p) => p.id == id);
      if (prod) total += prod.price * qty;
    }
    const deliveryCharge = total >= 199 ? 0 : (total === 0 ? 0 : 5);
    const grandTotal = total + deliveryCharge;

    if (grandTotal === 0) {
      alert("Your cart is empty.");
      return;
    }

    // Show popup
    orderDesc.textContent = "Thank you for shopping with Banerjee Mart!";
    orderPopup.style.display = "flex";

    // After 2 seconds redirect to orders.html
    setTimeout(() => {
      orderPopup.style.display = "none";
      window.location.href = "orders.html";
    }, 2000);
  });

  closePopupBtn.addEventListener("click", () => {
    orderPopup.style.display = "none";
  });

  orderPopup.addEventListener("click", (e) => {
    if (e.target === orderPopup) {
      orderPopup.style.display = "none";
    }
  });

  function setActiveNav() {
    const navLinks = document.querySelectorAll("nav.bottom-nav a");
    const path = window.location.pathname.split("/").pop().toLowerCase();
    navLinks.forEach((link) => {
      const href = link.getAttribute("href").toLowerCase();
      if (href === path || (href === "index.html" && (path === "" || path === "index.html"))) {
        link.classList.add("active");
      } else {
        link.classList.remove("active");
      }
    });
  }

  window.onload = () => {
    renderCart();
    setActiveNav();
  };
</script>

</body>
      </html>
